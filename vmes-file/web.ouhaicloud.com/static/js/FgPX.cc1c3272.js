(window.webpackJsonp=window.webpackJsonp||[]).push([["FgPX"],{FgPX:function(e,o,t){"use strict";t.r(o);t("rGqo"),t("yt8O"),t("RW0V"),t("Yfch");var r=t("L2JU"),n=t("XS0u");function i(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}o.default={data:function(){var e=this;return{loginForm:{username:"",password:"",authcode:""},loginRules:{username:[{required:!0,trigger:"blur",validator:function(e,o,t){o.trim()?t():t(new Error("请输入正确的用户名"))}}],password:[{required:!0,trigger:"blur",validator:function(e,o,t){o.length<0?t(new Error("密码不能小于5位")):t()}}],authcode:[{required:!0,trigger:"blur",validator:function(o,t,r){var n=t.toUpperCase();n&&e.authcode?n!==e.authcode?r(new Error("验证码错误")):r():r(new Error("验证码不匹配"))}}]},loading:!1,pwdType:"password",checked:!1,lading:null,codeTimer:""}},created:function(){var e=n.a.localGet("auth")||{};e.password&&(this.loginForm.username=e.username,this.loginForm.password=e.password,this.checked=!0),this.$loading(),this.changeCode(),this.$loading({}).close()},mounted:function(){},methods:{showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin:function(){var e=this,o=this;o.savePwd(o.checked),o.$refs.loginForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;o.loading=!0,o.$store.dispatch("Login",e.loginForm).then(function(e){clearTimeout(o.codeTimer),o.loading=!1,o.$store.dispatch("tagsView/delAllViews").then(function(e){var o=e.visitedViews;console.log(o)}),o.$router.push({path:"/home"})}).catch(function(){o.loading=!1,o.$loading({}).close()})})},savePwd:function(e){if(e){var o={username:this.loginForm.username,password:this.loginForm.password};console.log(o),n.a.localSet("auth",o)}else n.a.localRemove("auth")},changeCode:function(){var e=this;e.$store.dispatch("CreateSecurityCode",{}).then(function(){e.$refs.loginForm&&e.$refs.loginForm.clearValidate&&e.$refs.loginForm.clearValidate(),e.loginForm.authcode="",e.drawPic(e.authcode),clearTimeout(e.codeTimer),e.codeTimer=setTimeout(function(o){e.changeCode()},27e3)}).catch(function(){e.$refs.loginForm&&e.$refs.loginForm.clearValidate&&e.$refs.loginForm.clearValidate(),clearTimeout(e.codeTimer),e.codeTimer=setTimeout(function(o){e.changeCode()},27e3)})},drawPic:function(e){var o=document.getElementById("canvas"),t=o.width,r=o.height,n=o.getContext("2d");function i(e,o){return Math.floor(Math.random()*(o-e)+e)}function a(e,o){return"rgb("+i(e,o)+","+i(e,o)+","+i(e,o)+")"}n.textBaseline="bottom",n.fillStyle=a(180,240),n.fillRect(0,0,t,r);for(var c=e,l=0;l<4;l++){var s=c[l];n.fillStyle=a(50,160),n.font=i(18,30)+"px SimHei";var u=5+20*l,d=i(25,30),h=i(-30,30);n.translate(u,d),n.rotate(h*Math.PI/180),n.fillText(s,0,0),n.rotate(-h*Math.PI/180),n.translate(-u,-d)}}},computed:function(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(o){i(e,o,t[o])})}return e}({},Object(r.b)(["authcode"]),{btnState:function(){return!(this.loginForm.username&&this.loginForm.password&&this.loginForm.authcode)}}),watch:{checked:function(){this.checked||n.a.localRemove("auth")}}}}}]);